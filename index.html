<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion Pèlerinage - Diocèse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* Custom Green Theme adjustments */
        :root {
            --primary-green: #15803d; /* green-700 */
            --light-green: #f0fdf4;   /* green-50 */
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* Receipt Styles for Print */
        @media print {
            body * { visibility: hidden; }
            #receipt-content, #receipt-content * { visibility: visible; }
            #receipt-content { position: absolute; left: 0; top: 0; width: 100%; margin: 0; padding: 20px; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Navigation -->
    <nav class="bg-green-800 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3 cursor-pointer" onclick="app.navigate('home')">
                <i class="fas fa-cross text-2xl text-green-300"></i>
                <div>
                    <h1 class="text-xl font-bold tracking-wide">PÈLERINAGE NATIONAL</h1>
                    <p class="text-xs text-green-200">Foi & Espérance</p>
                </div>
            </div>
            <div class="hidden md:flex space-x-6" id="nav-links">
                <!-- Links injected by JS based on role -->
            </div>
            <div class="md:hidden">
                <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden bg-green-700 md:hidden p-4">
            <div id="mobile-nav-links" class="flex flex-col space-y-2"></div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main id="app" class="container mx-auto px-4 py-8 min-h-screen">
        <!-- Content injected by JS -->
    </main>

    <!-- Footer -->
    <footer class="bg-green-900 text-green-100 py-6 mt-12">
        <div class="container mx-auto text-center">
            <p>&copy; 2024 Comité d'Organisation du Pèlerinage. Tous droits réservés.</p>
        </div>
    </footer>

    <!-- JAVASCRIPT LOGIC (Simulating Django Views & Models) -->
    <script>
        const { jsPDF } = window.jspdf;

        // --- Mock Database (State) ---
        const db = {
            currentUser: null, // { name, role: 'admin' | 'user', email, ... }
            pilgrims: [
                { id: 'PEL-2024-001', prenom: 'Jean', nom: 'Kouassi', diocese: 'Abidjan', paroisse: 'St Paul', email: 'jean@test.com', phone: '07070707', paid: true, date: '2024-01-15' },
                { id: 'PEL-2024-002', prenom: 'Marie', nom: 'Koné', diocese: 'Bouaké', paroisse: 'Cathédrale', email: 'marie@test.com', phone: '05050505', paid: true, date: '2024-01-16' },
            ],
            intentions: [],
            shopOrders: [],
            donations: 0
        };

        // --- App Controller ---
        const app = {
            init: () => {
                app.navigate('auth');
            },

            navigate: (pageId, data = null) => {
                const main = document.getElementById('app');
                main.innerHTML = ''; // Clear content
                window.scrollTo(0,0);
                app.updateNav();

                switch(pageId) {
                    case 'auth': app.renderAuth(); break;
                    case 'registration': app.renderRegistration(); break;
                    case 'payment': app.renderPayment(data); break;
                    case 'receipt': app.renderReceipt(data); break;
                    case 'user-dashboard': app.renderUserDashboard(); break;
                    case 'admin-dashboard': app.renderAdminDashboard(); break;
                    default: app.renderAuth();
                }
            },

            updateNav: () => {
                const links = document.getElementById('nav-links');
                const mobileLinks = document.getElementById('mobile-nav-links');
                let html = '';

                if (!db.currentUser) {
                    html = `<a onclick="app.navigate('auth')" class="hover:text-green-200 cursor-pointer">Connexion</a>`;
                } else if (db.currentUser.role === 'admin') {
                    html = `
                        <a onclick="app.navigate('admin-dashboard')" class="hover:text-green-200 cursor-pointer font-semibold">Administration</a>
                        <a onclick="app.logout()" class="hover:text-red-300 cursor-pointer"><i class="fas fa-sign-out-alt"></i> Déconnexion</a>
                    `;
                } else {
                    html = `
                        <a onclick="app.navigate('user-dashboard')" class="hover:text-green-200 cursor-pointer">Mon Espace</a>
                        <a onclick="app.navigate('registration')" class="hover:text-green-200 cursor-pointer">Nouvelle Inscription</a>
                        <a onclick="app.logout()" class="hover:text-red-300 cursor-pointer"><i class="fas fa-sign-out-alt"></i> Déconnexion</a>
                    `;
                }
                links.innerHTML = html;
                mobileLinks.innerHTML = html;
            },

            login: (email, role) => {
                db.currentUser = { email, role, name: role === 'admin' ? 'Administrateur' : 'Pèlerin Fidèle' };
                if (role === 'admin') app.navigate('admin-dashboard');
                else app.navigate('user-dashboard');
            },

            logout: () => {
                db.currentUser = null;
                app.navigate('auth');
            },

            // --- VIEWS ---

            renderAuth: () => {
                const container = document.getElementById('app');
                container.innerHTML = `
                    <div class="max-w-md mx-auto bg-white rounded-xl shadow-xl overflow-hidden fade-in mt-10">
                        <div class="bg-green-700 py-6 text-center">
                            <i class="fas fa-church text-4xl text-white mb-2"></i>
                            <h2 class="text-2xl font-bold text-white">Bienvenue</h2>
                            <p class="text-green-200">Portail du Pèlerinage</p>
                        </div>
                        <div class="p-8">
                            <div class="mb-6 text-center border-b pb-4">
                                <p class="text-gray-600 mb-4">Choisissez votre accès</p>
                                <div class="grid grid-cols-2 gap-4">
                                    <button onclick="app.login('admin@diocese.ci', 'admin')" class="p-3 border border-green-600 text-green-700 rounded hover:bg-green-50">
                                        <i class="fas fa-user-shield block mb-1"></i> Admin
                                    </button>
                                    <button onclick="app.login('pelerin@email.com', 'user')" class="p-3 bg-green-600 text-white rounded hover:bg-green-700 shadow-md">
                                        <i class="fas fa-user block mb-1"></i> Pèlerin
                                    </button>
                                </div>
                                <p class="text-xs text-gray-400 mt-2">Simulation: Cliquez pour entrer directement</p>
                            </div>
                            <div class="text-center">
                                <p class="text-sm text-gray-600">Pas encore inscrit pour cette année ?</p>
                                <button onclick="app.navigate('registration')" class="mt-2 text-green-700 font-semibold hover:underline">S'inscrire au Pèlerinage</button>
                            </div>
                        </div>
                    </div>
                `;
            },

            renderRegistration: () => {
                // PAGE 2: FORMULAIRE
                const container = document.getElementById('app');
                container.innerHTML = `
                    <div class="max-w-3xl mx-auto bg-white rounded-lg shadow-lg p-8 fade-in">
                        <h2 class="text-2xl font-bold text-green-800 mb-6 border-b pb-2"><i class="fas fa-file-signature"></i> Formulaire d'Inscription</h2>
                        <form onsubmit="event.preventDefault(); app.handleFormSubmit(this);">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Nom</label>
                                    <input type="text" name="nom" required class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Prénom</label>
                                    <input type="text" name="prenom" required class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Date de Naissance</label>
                                    <input type="date" name="dob" required class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Numéro Téléphone</label>
                                    <input type="tel" name="phone" required placeholder="07 XX XX XX XX" class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                    <input type="email" name="email" required class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Diocèse</label>
                                    <select name="diocese" class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-500 focus:outline-none">
                                        <option>Abidjan</option>
                                        <option>Yopougon</option>
                                        <option>Bouaké</option>
                                        <option>Katiola</option>
                                        <option>San Pedro</option>
                                    </select>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Paroisse / CCB</label>
                                    <input type="text" name="paroisse" required class="w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-green-500 focus:outline-none">
                                </div>
                            </div>
                            <div class="mt-8 flex justify-end">
                                <button type="button" onclick="app.navigate('home')" class="mr-4 px-6 py-2 text-gray-600 hover:text-gray-800">Annuler</button>
                                <button type="submit" class="bg-green-600 text-white px-8 py-2 rounded shadow hover:bg-green-700 transition">
                                    Continuer vers le Paiement <i class="fas fa-arrow-right ml-2"></i>
                                </button>
                            </div>
                        </form>
                    </div>
                `;
            },

            handleFormSubmit: (form) => {
                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());
                // In Django, this would be a POST to a view, then redirect to Payment
                app.navigate('payment', data);
            },

            renderPayment: (pilgrimData) => {
                // PAGE 3: API ORANGE MONEY
                const amount = 15000; // Example amount
                const container = document.getElementById('app');
                container.innerHTML = `
                    <div class="max-w-md mx-auto fade-in">
                        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                            <div class="bg-black p-4 flex justify-between items-center">
                                <h3 class="text-orange-500 font-bold text-lg">Orange Money</h3>
                                <div class="bg-orange-500 h-6 w-6 rounded-full"></div>
                            </div>
                            <div class="p-6">
                                <div class="text-center mb-6">
                                    <p class="text-gray-500 text-sm">Montant à payer</p>
                                    <h2 class="text-3xl font-bold text-gray-800">${amount.toLocaleString()} FCFA</h2>
                                    <p class="text-sm text-green-600 mt-2">Inscription Pèlerinage: ${pilgrimData.nom} ${pilgrimData.prenom}</p>
                                </div>

                                <div class="space-y-4">
                                    <div>
                                        <label class="text-xs font-bold text-gray-500 uppercase">Numéro Orange Money</label>
                                        <div class="flex items-center border rounded p-2 mt-1 bg-gray-50">
                                            <span class="text-gray-500 mr-2">+225</span>
                                            <input type="text" value="${pilgrimData.phone}" class="bg-transparent w-full outline-none font-mono">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="text-xs font-bold text-gray-500 uppercase">Code Secret (Simulation)</label>
                                        <input type="password" placeholder="****" class="w-full border rounded p-2 mt-1 outline-none focus:border-orange-500">
                                    </div>
                                    
                                    <button onclick="app.processPayment(${JSON.stringify(pilgrimData).replace(/"/g, '&quot;')})" 
                                        class="w-full bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 rounded transition flex justify-center items-center">
                                        <span id="pay-text">Confirmer le paiement</span>
                                        <i id="pay-spinner" class="fas fa-spinner fa-spin ml-2 hidden"></i>
                                    </button>
                                </div>
                                <div class="mt-4 text-center">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Orange_logo.svg/1200px-Orange_logo.svg.png" alt="Orange" class="h-8 mx-auto opacity-50">
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },

            processPayment: (data) => {
                // Simulate API Call
                const btnText = document.getElementById('pay-text');
                const spinner = document.getElementById('pay-spinner');
                
                btnText.textContent = "Traitement en cours...";
                spinner.classList.remove('hidden');

                setTimeout(() => {
                    // Generate Pilgrim ID
                    const randomNum = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
                    const pilgrimId = `PEL-2024-${randomNum}`;
                    
                    const finalData = { ...data, id: pilgrimId, paid: true, date: new Date().toLocaleDateString() };
                    
                    // Save to DB
                    db.pilgrims.push(finalData);
                    db.donations += 15000;

                    app.navigate('receipt', finalData);
                }, 2000);
            },

            renderReceipt: (data) => {
                // RECU FINAL
                const container = document.getElementById('app');
                container.innerHTML = `
                    <div class="max-w-2xl mx-auto text-center mb-6 no-print">
                        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
                            <strong class="font-bold">Félicitations !</strong>
                            <span class="block sm:inline">Votre inscription est validée. Voici votre reçu officiel.</span>
                        </div>
                        <button onclick="window.print()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                            <i class="fas fa-print mr-2"></i>Imprimer le Reçu
                        </button>
                         <button onclick="app.login('${data.email}', 'user')" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 ml-2">
                            Aller à mon Espace
                        </button>
                    </div>

                    <div id="receipt-content" class="max-w-2xl mx-auto bg-white p-10 shadow-2xl border-t-8 border-green-600 relative overflow-hidden">
                        <!-- Watermark -->
                        <div class="absolute inset-0 flex items-center justify-center opacity-5 pointer-events-none">
                            <i class="fas fa-cross text-9xl text-green-900"></i>
                        </div>

                        <div class="flex justify-between items-start mb-8 relative z-10">
                            <div class="text-left">
                                <h1 class="text-3xl font-bold text-green-800">REÇU DE PÈLERINAGE</h1>
                                <p class="text-gray-500">Édition 2024</p>
                            </div>
                            <div class="text-right">
                                <div class="bg-green-100 text-green-800 px-3 py-1 rounded font-mono font-bold text-lg border border-green-200">
                                    N° ${data.id}
                                </div>
                                <p class="text-xs text-gray-500 mt-1">Date: ${data.date}</p>
                            </div>
                        </div>

                        <div class="border-b-2 border-green-100 mb-8 pb-8 relative z-10">
                            <div class="grid grid-cols-2 gap-y-6">
                                <div>
                                    <p class="text-sm text-gray-500 uppercase">Nom & Prénom</p>
                                    <p class="font-bold text-xl">${data.nom.toUpperCase()} ${data.prenom}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 uppercase">Diocèse</p>
                                    <p class="font-bold text-lg">${data.diocese}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 uppercase">Paroisse / CCB</p>
                                    <p class="font-semibold">${data.paroisse}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500 uppercase">Contact</p>
                                    <p class="font-semibold">${data.phone}</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-50 p-4 rounded mb-8 relative z-10">
                            <div class="flex justify-between items-center">
                                <span class="font-bold text-gray-700">Frais d'inscription & Kit Pèlerin</span>
                                <span class="font-bold text-green-700">15,000 FCFA</span>
                            </div>
                            <div class="mt-2 text-xs text-gray-400 border-t pt-2 flex justify-between">
                                <span>Moyen de paiement: Orange Money</span>
                                <span>Statut: <span class="text-green-600 font-bold">PAYÉ</span></span>
                            </div>
                        </div>

                        <div class="text-center text-sm text-gray-500 relative z-10">
                            <p>Ce reçu est obligatoire pour le retrait de votre kit.</p>
                            <p class="italic mt-2">"Heureux les pèlerins car ils verront Dieu."</p>
                        </div>
                        
                        <!-- QR Code simulation -->
                        <div class="absolute bottom-4 right-4 text-green-900 opacity-20">
                            <i class="fas fa-qrcode text-6xl"></i>
                        </div>
                    </div>
                `;
            },

            renderUserDashboard: () => {
                // ESPACE CLIENT
                if (!db.currentUser) return app.navigate('auth');

                const container = document.getElementById('app');
                container.innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8 fade-in">
                        <!-- Sidebar Info -->
                        <div class="lg:col-span-1">
                            <div class="bg-white p-6 rounded-lg shadow mb-6 text-center">
                                <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 text-green-600 text-3xl">
                                    <i class="fas fa-user"></i>
                                </div>
                                <h3 class="font-bold text-xl mb-1">${db.currentUser.role === 'user' ? 'Fidèle Pèlerin' : 'Admin'}</h3>
                                <p class="text-gray-500 text-sm mb-4">${db.currentUser.email}</p>
                                <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Inscrit Validé</span>
                            </div>
                        </div>

                        <!-- Main Actions -->
                        <div class="lg:col-span-3 space-y-6">
                            
                            <!-- Welcome Banner -->
                            <div class="bg-gradient-to-r from-green-700 to-green-600 rounded-lg p-6 text-white shadow-lg flex justify-between items-center">
                                <div>
                                    <h2 class="text-2xl font-bold mb-2">Paix et Joie !</h2>
                                    <p class="opacity-90">Gérez vos intentions et vos achats ici.</p>
                                </div>
                                <i class="fas fa-dove text-5xl opacity-20"></i>
                            </div>

                            <!-- Modules Grid -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Intentions de Messe -->
                                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-yellow-500">
                                    <div class="flex justify-between items-start mb-4">
                                        <h3 class="font-bold text-lg text-gray-800">Intentions de Messe</h3>
                                        <i class="fas fa-pray text-yellow-500 text-xl"></i>
                                    </div>
                                    <p class="text-sm text-gray-600 mb-4">Confiez vos prières pour les célébrations.</p>
                                    <button onclick="alert('Module Intention: Une fenêtre modale s\\'ouvrirait ici pour saisir l\\'intention.')" class="w-full py-2 border border-gray-300 rounded hover:bg-gray-50 text-sm">Déposer une intention</button>
                                </div>

                                <!-- Boutique -->
                                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-blue-500">
                                    <div class="flex justify-between items-start mb-4">
                                        <h3 class="font-bold text-lg text-gray-800">Boutique Officielle</h3>
                                        <i class="fas fa-tshirt text-blue-500 text-xl"></i>
                                    </div>
                                    <p class="text-sm text-gray-600 mb-4">T-shirts, Chapelets, Gadgets souvenirs.</p>
                                    <div class="space-y-2">
                                        <div class="flex justify-between items-center text-sm p-2 bg-gray-50 rounded">
                                            <span>T-shirt 2024</span>
                                            <button class="text-blue-600 font-bold hover:underline">Acheter (5000 F)</button>
                                        </div>
                                        <div class="flex justify-between items-center text-sm p-2 bg-gray-50 rounded">
                                            <span>Chapelet</span>
                                            <button class="text-blue-600 font-bold hover:underline">Acheter (2000 F)</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Dons -->
                                <div class="bg-white p-6 rounded-lg shadow border-l-4 border-red-500">
                                    <div class="flex justify-between items-start mb-4">
                                        <h3 class="font-bold text-lg text-gray-800">Faire un Don</h3>
                                        <i class="fas fa-hand-holding-heart text-red-500 text-xl"></i>
                                    </div>
                                    <p class="text-sm text-gray-600 mb-4">Soutenez l'organisation du pèlerinage.</p>
                                    <button onclick="app.navigate('payment', {nom: 'Donateur', prenom: 'Anonyme', id:'DON', amount: 0})" class="w-full bg-red-50 text-red-600 py-2 rounded hover:bg-red-100 font-semibold">Je donne</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            },

            renderAdminDashboard: () => {
                // GESTION ADMIN
                if (!db.currentUser || db.currentUser.role !== 'admin') return app.navigate('auth');

                const totalPilgrims = db.pilgrims.length;
                const totalMoney = db.pilgrims.length * 15000;

                const container = document.getElementById('app');
                container.innerHTML = `
                    <div class="fade-in">
                        <div class="flex justify-between items-center mb-8">
                            <h2 class="text-2xl font-bold text-gray-800">Tableau de Bord Administrateur</h2>
                            <button class="bg-green-700 text-white px-4 py-2 rounded shadow hover:bg-green-800">
                                <i class="fas fa-download mr-2"></i>Exporter Excel
                            </button>
                        </div>

                        <!-- Stats Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                            <div class="bg-white p-6 rounded shadow border-b-4 border-green-600">
                                <p class="text-gray-500 text-sm">Pèlerins Inscrits</p>
                                <p class="text-3xl font-bold text-green-700">${totalPilgrims}</p>
                            </div>
                            <div class="bg-white p-6 rounded shadow border-b-4 border-orange-500">
                                <p class="text-gray-500 text-sm">Fonds Collectés (FCFA)</p>
                                <p class="text-3xl font-bold text-orange-600">${totalMoney.toLocaleString()}</p>
                            </div>
                            <div class="bg-white p-6 rounded shadow border-b-4 border-blue-500">
                                <p class="text-gray-500 text-sm">T-shirts Vendus</p>
                                <p class="text-3xl font-bold text-blue-600">124</p>
                            </div>
                            <div class="bg-white p-6 rounded shadow border-b-4 border-yellow-500">
                                <p class="text-gray-500 text-sm">Intentions de Messe</p>
                                <p class="text-3xl font-bold text-yellow-600">45</p>
                            </div>
                        </div>

                        <!-- Pilgrims Table -->
                        <div class="bg-white rounded shadow overflow-hidden">
                            <div class="p-4 border-b flex justify-between items-center bg-gray-50">
                                <h3 class="font-bold text-gray-700">Liste des Inscrits Récents</h3>
                                <input type="text" placeholder="Rechercher..." class="border rounded px-3 py-1 text-sm focus:outline-none focus:border-green-500">
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left border-collapse">
                                    <thead>
                                        <tr class="text-sm text-gray-500 border-b bg-gray-50">
                                            <th class="p-4 font-medium">ID Pèlerin</th>
                                            <th class="p-4 font-medium">Nom & Prénom</th>
                                            <th class="p-4 font-medium">Diocèse</th>
                                            <th class="p-4 font-medium">Contact</th>
                                            <th class="p-4 font-medium">Statut</th>
                                            <th class="p-4 font-medium">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-sm">
                                        ${db.pilgrims.map(p => `
                                            <tr class="border-b hover:bg-gray-50">
                                                <td class="p-4 font-mono text-xs font-bold text-gray-600">${p.id}</td>
                                                <td class="p-4 font-bold text-gray-800">${p.nom.toUpperCase()} ${p.prenom}</td>
                                                <td class="p-4">${p.diocese}</td>
                                                <td class="p-4">${p.phone}</td>
                                                <td class="p-4"><span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-bold">PAYÉ</span></td>
                                                <td class="p-4">
                                                    <button onclick="app.navigate('receipt', ${JSON.stringify(p).replace(/"/g, '&quot;')})" class="text-blue-600 hover:text-blue-800" title="Voir Reçu"><i class="fas fa-eye"></i></button>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
            }
        };

        // Start App
        window.onload = app.init;

    </script>
</body>
</html>
